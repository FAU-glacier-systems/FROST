# @package _global_

defaults:
  - override /inputs:
      - load_ncdf
  - override /processes:
      - data_assimilation
      - iceflow
  - override /outputs: [ ]
inputs:
  load_ncdf:
    input_file: input.nc
processes:
  iceflow:
    physics:
      init_slidingco: 0.045
    emulator:
      save_model: true
      retrain_freq: 1
  data_assimilation:
    output:
      save_result_in_ncdf: ../../output.nc
      vars_to_save:
        - usurf
        - topg
        - thk
        - slidingco
        - velsurf_mag
        - velsurfobs_mag
        - divflux
        - icemask
        - arrhenius
        - thkobs
        - dhdt
      plot2d_live: false
      plot2d: false
    control_list:
      - thk
      - slidingco
      - usurf
    cost_list:
      - velsurf
      - icemask
      - thk
      - usurf
      - divfluxfcz
    optimization:
      retrain_iceflow_model: true
      nbitmax: 500
    fitting:
       usurfobs_std: 0.3
       velsurfobs_std: 0.25
       thkobs_std: 10
       divfluxobs_std: 0.1
    regularization:
       thk: 1.0
       slidingco: 1.0e6
       smooth_anisotropy_factor: 1.0
       convexity_weight: 0.0

